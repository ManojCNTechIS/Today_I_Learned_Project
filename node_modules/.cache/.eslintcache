[{"/Users/manojcn/today-i-learned/src/index.js":"1","/Users/manojcn/today-i-learned/src/App.js":"2","/Users/manojcn/today-i-learned/src/supabase.js":"3"},{"size":233,"mtime":1679897810395,"results":"4","hashOfConfig":"5"},{"size":7417,"mtime":1679925257829,"results":"6","hashOfConfig":"5"},{"size":436,"mtime":1679920039055,"results":"7","hashOfConfig":"5"},{"filePath":"8","messages":"9","suppressedMessages":"10","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"s595qt",{"filePath":"11","messages":"12","suppressedMessages":"13","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"14"},{"filePath":"15","messages":"16","suppressedMessages":"17","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/manojcn/today-i-learned/src/index.js",[],[],"/Users/manojcn/today-i-learned/src/App.js",["18"],[],"import { useEffect, useState } from \"react\";\nimport supabase from \"./supabase\";\nimport \"./style.css\";\n\nconst CATEGORIES = [\n  { name: \"technology\", color: \"#3b82f6\" },\n  { name: \"science\", color: \"#16a34a\" },\n  { name: \"finance\", color: \"#ef4444\" },\n  { name: \"society\", color: \"#eab308\" },\n  { name: \"entertainment\", color: \"#db2777\" },\n  { name: \"health\", color: \"#14b8a6\" },\n  { name: \"history\", color: \"#f97316\" },\n  { name: \"news\", color: \"#8b5cf6\" },\n];\n\nfunction App() {\n  const [showForm, setShowForm] = useState(false);\n  const [facts, setFacts] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [currentCategory, setCurrentCategory] = useState(\"all\");\n\n  useEffect(\n    function () {\n      async function getFacts() {\n        setIsLoading(true);\n\n        let query = supabase.from(\"facts\").select(\"*\");\n\n        if (currentCategory !== \"all\")\n          query = query.eq(\"category\", currentCategory);\n\n        const { data: facts, error } = await query\n          .order(\"votesInteresting\", { ascending: false })\n          .limit(1000);\n\n        if (!error) setFacts(facts);\n        else alert(\"There was a problem getting data\");\n        setIsLoading(false);\n      }\n      getFacts();\n    },\n    [currentCategory]\n  );\n\n  return (\n    <>\n      <Header showForm={showForm} setShowForm={setShowForm} />\n\n      {showForm ? (\n        <NewFactForm setFacts={setFacts} setShowForm={setShowForm} />\n      ) : null}\n\n      <main className=\"main\">\n        <CategoryFilter setCurrentCategory={setCurrentCategory} />\n\n        {isLoading ? (\n          <Loader />\n        ) : (\n          <FactList facts={facts} setFacts={setFacts} />\n        )}\n      </main>\n    </>\n  );\n}\n\nfunction Loader() {\n  return <p className=\"message\">Loading...</p>;\n}\n\nfunction Header(props) {\n  const appTitle = \"Today I Learned\";\n\n  return (\n    <header className=\"header\">\n      <div className=\"logo\">\n        <img src=\"./logo.png\" alt=\"Logo\" />\n        <h1>{appTitle}</h1>\n      </div>\n\n      <button\n        className=\"btn btn-large btn-open\"\n        onClick={() => props.setShowForm((show) => !show)}\n      >\n        {props.showForm ? \"Close\" : \"Share a Fact\"}\n      </button>\n    </header>\n  );\n}\n\nfunction isValidHttpUrl(string) {\n  let url;\n  try {\n    url = new URL(string);\n  } catch (_) {\n    return false;\n  }\n  return url.protocol === \"http:\" || url.protocol === \"https:\";\n}\n\nfunction NewFactForm(props) {\n  const [text, setText] = useState(\"\");\n  const [source, setSource] = useState(\"\");\n  const [category, setCategory] = useState(\"\");\n  const [isUploading, setIsUploading] = useState(false);\n  const textLength = text.length;\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n\n    if (text && isValidHttpUrl(source) && category && textLength <= 200) {\n      // const newFact = {\n      //   id: Math.round(Math.random() * 100000000),\n      //   text,\n      //   source,\n      //   category,\n      //   votesInteresting: 0,\n      //   votesMindblowing: 0,\n      //   votesFalse: 0,\n      //   createdIn: new Date().getFullYear(),\n      // };\n\n      setIsUploading(true);\n      const { data: newFact, error } = await supabase\n        .from(\"facts\")\n        .insert([{ text, source, category }])\n        .select();\n      setIsUploading(false);\n\n      if (!error) props.setFacts((facts) => [newFact[0], ...facts]);\n\n      setText(\"\");\n      setSource(\"\");\n      setCategory(\"\");\n\n      props.setShowForm(false);\n    }\n  }\n\n  return (\n    <form className=\"fact-form\" onSubmit={handleSubmit}>\n      <input\n        type=\"text\"\n        placeholder=\"Share a fact with world...\"\n        value={text}\n        onChange={(e) => setText(e.target.value)}\n        disabled={isUploading}\n      />\n      <span>{200 - textLength}</span>\n      <input\n        type=\"text\"\n        placeholder=\"Trustworthy source...\"\n        value={source}\n        onChange={(e) => setSource(e.target.value)}\n        disabled={isUploading}\n      />\n      <select\n        value={category}\n        onChange={(e) => setCategory(e.target.value)}\n        name=\"\"\n        id=\"\"\n        disabled={isUploading}\n      >\n        <option value=\"\">Choose Category:</option>\n        {CATEGORIES.map((cat) => (\n          <option key={cat.name} value={cat.name}>\n            {cat.name.toLocaleUpperCase()}\n          </option>\n        ))}\n      </select>\n      <button className=\"btn btn-large\" disabled={isUploading}>\n        Post\n      </button>\n    </form>\n  );\n}\n\nfunction CategoryFilter(props) {\n  return (\n    <aside>\n      <ul>\n        <li className=\"category\">\n          <button\n            className=\"btn btn-all-categories\"\n            onClick={() => props.setCurrentCategory(\"all\")}\n          >\n            All\n          </button>\n        </li>\n        {CATEGORIES.map((cat) => (\n          <li key={cat.name} className=\"category\">\n            <button\n              className=\"btn btn-categories\"\n              style={{\n                backgroundColor: cat.color,\n              }}\n              onClick={() => props.setCurrentCategory(cat.name)}\n            >\n              {cat.name}\n            </button>\n          </li>\n        ))}\n      </ul>\n    </aside>\n  );\n}\n\nfunction FactList(props) {\n  if (props.facts.length === 0)\n    return (\n      <p className=\"message\">\n        No facts for this category yet! Create the first one ‚úåÔ∏è\n      </p>\n    );\n\n  return (\n    <section>\n      <ul className=\"facts-list\">\n        {props.facts.map((fact) => (\n          <Fact key={fact.id} fact={fact} setFacts={props.setFacts} />\n        ))}\n      </ul>\n      <p>There are {props.facts.length} facts in the database. Add your own!</p>\n    </section>\n  );\n}\n\nfunction Fact(props) {\n  const [isUpdating, setIsUpdating] = useState(false);\n  const isDisputed =\n    props.fact.votesInteresting + props.fact.votesMindblowing <\n    props.fact.votesFalse;\n\n  async function handleVote(columnName) {\n    setIsUpdating(true);\n    const { data: updatedFact, error } = await supabase\n      .from(\"facts\")\n      .update({ [columnName]: props.fact[columnName] + 1 })\n      .eq(\"id\", props.fact.id)\n      .select();\n    setIsUpdating(false);\n\n    if (!error)\n      props.setFacts((facts) =>\n        facts.map((f) => (f.id === props.fact.id ? updatedFact[0] : f))\n      );\n  }\n\n  return (\n    <li className=\"fact\">\n      <p>\n        {isDisputed ? <span className=\"disputed\">[‚õîÔ∏è DISPUTED]</span> : null}\n        {props.fact.text}\n        {props.fact.text}\n        <a\n          className=\"source\"\n          rel=\"noreferrrer\"\n          target=\"_blank\"\n          href={props.fact.source}\n        >\n          (Source)\n        </a>\n      </p>\n      <span\n        className=\"tag\"\n        style={{\n          backgroundColor: CATEGORIES.find(\n            (cat) => cat.name === props.fact.category\n          ).color,\n        }}\n      >\n        {props.fact.category}\n      </span>\n      <div className=\"vote-buttons\">\n        <button\n          onClick={() => handleVote(\"votesInteresting\")}\n          disabled={isUpdating}\n        >\n          üëç {props.fact.votesInteresting}\n        </button>\n        <button\n          onClick={() => handleVote(\"votesMindblowing\")}\n          disabled={isUpdating}\n        >\n          ü§Ø {props.fact.votesMindblowing}\n        </button>\n        <button onClick={() => handleVote(\"votesFalse\")} disabled={isUpdating}>\n          ‚õîÔ∏è {props.fact.votesFalse}\n        </button>\n      </div>\n    </li>\n  );\n}\n\nexport default App;\n","/Users/manojcn/today-i-learned/src/supabase.js",[],[],{"ruleId":"19","severity":1,"message":"20","line":254,"column":9,"nodeType":"21","messageId":"22","endLine":259,"endColumn":10,"fix":"23"},"react/jsx-no-target-blank","Using target=\"_blank\" without rel=\"noreferrer\" (which implies rel=\"noopener\") is a security risk in older browsers: see https://mathiasbynens.github.io/rel-noopener/#recommendations","JSXOpeningElement","noTargetBlankWithoutNoreferrer",{"range":"24","text":"25"},[6465,6478],"\"noreferrrer noreferrer\""]